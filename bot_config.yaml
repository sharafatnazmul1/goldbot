# ============================================================================
# GOLDBOT - XAUUSD Breakout Trading System Configuration
# ============================================================================

# --- MetaTrader5 Connection ---
mt5:
  login: 270151243           # Replace with your MT5 account number
  password: "@@Sharafatnh6@@" # Replace with your MT5 password
  server: "Exness-MT5Trial17"  # Replace with your broker server name
  timeout: 60000            # Connection timeout in ms
  path: C:\Program Files\MetaTrader 5\terminal64.exe                # Path to MT5 terminal (leave empty for auto-detect)

# --- Telegram Configuration ---
telegram:
  enabled: false
  bot_token: "YOUR_BOT_TOKEN_HERE"  # Replace with your Telegram bot token
  chat_id: "YOUR_CHAT_ID_HERE"      # Replace with your Telegram chat ID
  send_startup: true
  send_trades: true
  send_errors: true
  send_daily_summary: true

# --- Trading Symbol ---
symbol: "XAUUSDm"
point_value: 100.0         # XAUUSD contract size: 100 troy ounces per lot (FIX #1)

# --- Timeframes ---
timeframes:
  primary: "M5"            # Primary analysis timeframe
  confirm: "M1"            # Confirmation timeframe
  bias: "H1"               # HTF bias timeframe

# --- Risk Management (SCALPING) ---
risk:
  risk_per_trade: 0.08     # 8% default - scales down with account growth (see dynamic_risk_tiers)
  max_position_risk: 16.0  # Maximum 16% in concurrent positions (2 trades @ 8%)
  max_concurrent_trades: 2 # Maximum 2 simultaneous scalps
  daily_loss_limit: 0.15   # 15% daily loss limit for scalping
  weekly_loss_limit: 0.25  # 25% weekly loss limit
  max_drawdown_limit: 0.30 # 30% max drawdown from peak
  consecutive_loss_limit: 6 # Stop after 6 consecutive losses
  min_equity: 10.0         # Scalping works from $10

  # Dynamic risk scaling for account growth (equity ranges)
  dynamic_risk_tiers:
    - max_equity: 50.0
      risk_pct: 0.08       # 8% for accounts under $50
    - max_equity: 100.0
      risk_pct: 0.05       # 5% for $50-$100
    - max_equity: 500.0
      risk_pct: 0.02       # 2% for $100-$500
    - max_equity: 9999999
      risk_pct: 0.01       # 1% for accounts above $500

# --- Position Sizing ---
position:
  min_lot: 0.01            # Exness minimum lot size
  max_lot: 10.0            # Maximum lot size
  lot_step: 0.01           # Lot size increment

# --- ATR / Volatility Settings ---
atr:
  period: 14
  volatility_threshold: 0.8    # Minimum ATR in $ to allow trades
  high_threshold: 2.0          # High volatility boundary

# --- Scoring System ---
scoring:
  threshold_trade: 60      # Minimum score to enter trade
  threshold_high: 80       # High confidence threshold

  # Weights for scoring
  weights:
    session: 20
    sweep: 30
    rejection: 15
    impulse: 20
    fvg: 15
    htf_bias_aligned: 10
    htf_bias_opposed: -10
    high_volatility: 5
    volume_confirm: 5
    narrow_range: -10

# --- Session Windows (UTC) ---
sessions:
  london:
    start: "07:00"
    end: "10:30"
  newyork:
    start: "12:30"
    end: "15:30"
  no_trade:
    start: "23:50"
    end: "00:10"

# --- News Filter ---
news:
  enabled: false           # Set to true to enable news filtering
  buffer_minutes: 30       # Minutes before/after high-impact news

# --- Spread & Filters ---
filters:
  max_spread: 0.18         # Maximum allowed spread in $

# --- Retracement Settings ---
retracement:
  shallow_min: 0.10        # 10% minimum retrace for shallow entry
  shallow_max: 0.40        # 40% maximum retrace for shallow entry
  shallow_ratio: 0.30      # Default 30% retrace entry point

# --- Stop Loss & Take Profit ---
stop_loss:
  buffer: 0.10             # $0.10 buffer above/below sweep wick
  minimum: 2.50            # Minimum SL distance in $

take_profit:
  tp1_multiplier: 0.8      # TP1 = 0.8R (quick scalp exit)
  tp2_multiplier: 1.5      # TP2 = 1.5R (max scalp target)
  partial_close_pct: 0.7   # Close 70% at TP1, let 30% run to TP2

# --- Trade Management (SCALPING) ---
trade_management:
  breakeven_at_r: 0.3      # Move to breakeven at 0.3R (early protection)
  trail_at_r: 999.0        # Trailing DISABLED for scalping (use fixed TP only)
  trail_atr_mult: 0.3      # Not used (trailing disabled)
  max_hold_bars: 8         # Maximum 8 M5 bars = 40 minutes hold time
  min_time_between_trades: 60   # Minimum 60 seconds between trades
  max_trades_per_session: 20    # Up to 20 trades per session (scalping frequency)
  cooloff_after_loss: 120       # 2 min cooloff after loss (quick recovery)

# --- Lookback Periods ---
lookback:
  swing: 7                 # Bars to look back for swing high/low
  avg_body: 10             # Period for average body size calculation

# --- Entry Models ---
entry_models:
  momentum_break:
    enabled: true
    execution_type: "IOC"  # Immediate or Cancel
    max_slippage: 0.10     # Maximum allowed slippage in $

  shallow_retest:
    enabled: true
    execution_type: "LIMIT"
    cancel_after_bars: 3   # Cancel limit order after N M5 bars

  fvg_sniper:
    enabled: true
    execution_type: "LIMIT"
    fvg_entry_ratio: 0.5   # Enter at 50% of FVG zone
    cancel_after_bars: 5

# --- HTF Bias Settings ---
htf_bias:
  enabled: true
  ema_period: 20           # EMA period on H1 for bias

# --- Impulse / Displacement Settings ---
impulse:
  body_multiplier: 1.5     # Body must be 1.5x average
  volume_enabled: false    # Volume confirmation (if available)
  volume_multiplier: 1.2   # Volume must be 1.2x average

# --- Operational Settings ---
operational:
  loop_sleep_seconds: 1    # Sleep time in main loop
  order_retry_attempts: 3  # Retry failed orders N times
  order_retry_delay: 2     # Seconds between retries
  log_level: "INFO"        # DEBUG, INFO, WARNING, ERROR, CRITICAL
  log_file: "goldbot.log"

# --- Backtest Settings ---
backtest:
  start_date: "2024-11-01"
  end_date: "2024-11-30"
  initial_balance: 100.0
  commission_per_lot: 0.18  # Commission if applicable
  generate_report: true
  report_file: "backtest_report.html"

# --- Safety & Failsafes ---
safety:
  check_connection_interval: 60  # Check MT5 connection every N seconds
  max_spread_multiplier: 2.0     # Exit if spread > normal * multiplier
  idempotency_enabled: true      # Prevent duplicate orders
  recheck_sl_tp: true            # Verify SL/TP after order placement
